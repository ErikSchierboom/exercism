allergens : [Text]
allergens = ["eggs", "peanuts", "shellfish", "strawberries", "tomatoes", "chocolate", "pollen", "cats"]

allergies.allergicTo : Text -> Nat -> Boolean
allergies.allergicTo allergen score =
  match List.indexOf [allergen] allergens with
    Some idx -> isSetBit idx score
    None -> false

allergies.list : Nat -> [Text]
allergies.list score = List.filter (allergen -> allergicTo allergen score) allergens